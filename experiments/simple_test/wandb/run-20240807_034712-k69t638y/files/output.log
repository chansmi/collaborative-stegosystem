2024-08-07 03:47:13,278 - INFO - Script arguments: ScriptArguments(model_name='huggyllama/llama-7b', dataset_name='Anthropic/hh-rlhf', rm_adapter='trl-lib/llama-7b-hh-rm-adapter', log_with=None, use_safetensors=False, seed=0, use_score_scaling=False, use_score_norm=False, score_clip=None)
2024-08-07 03:47:13,278 - INFO - Loading tokenizer
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message.
2024-08-07 03:47:13,528 - INFO - Loading dataset: Anthropic/hh-rlhf
2024-08-07 03:47:15,554 - INFO - Dataset loaded. Size: 1608
2024-08-07 03:47:15,554 - INFO - Preparing dataset
2024-08-07 03:47:15,595 - INFO - Dataset preparation completed
2024-08-07 03:47:16,004 - INFO - Using device: cuda
2024-08-07 03:47:16,004 - INFO - Loading model: huggyllama/llama-7b
2024-08-07 03:47:16,004 - INFO - Loading model: huggyllama/llama-7b
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
2024-08-07 03:47:16,754 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.55s/it]
2024-08-07 03:47:20,135 - INFO - Model loaded on device: cuda

Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████| 2/2 [00:06<00:00,  3.04s/it]
2024-08-07 03:47:26,745 - INFO - Loading dataset: Anthropic/hh-rlhf
2024-08-07 03:47:27,599 - INFO - Dataset loaded. Size: 1608
2024-08-07 03:47:27,600 - INFO - Preparing dataset
2024-08-07 03:47:27,660 - INFO - Dataset preparation completed
2024-08-07 03:47:31,289 - INFO - Model loaded on device: cuda
/usr/local/lib/python3.10/dist-packages/accelerate/accelerator.py:488: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
2024-08-07 03:47:31,478 - INFO - Starting training loop
  0%|                                                                                                                | 0/201 [00:00<?, ?it/s]2024-08-07 03:47:31,481 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:47:31,481 - INFO - input_ids type: <class 'list'>
2024-08-07 03:47:31,482 - INFO - input_ids shape: torch.Size([9])
We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
2024-08-07 03:47:40,146 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  0%|▌                                                                                                       | 1/201 [00:08<29:01,  8.71s/it]2024-08-07 03:47:40,187 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:47:40,187 - INFO - input_ids type: <class 'list'>
2024-08-07 03:47:40,187 - INFO - input_ids shape: torch.Size([6])
2024-08-07 03:47:48,362 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  1%|█                                                                                                       | 2/201 [00:16<27:55,  8.42s/it]2024-08-07 03:47:48,403 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:47:48,403 - INFO - input_ids type: <class 'list'>
2024-08-07 03:47:48,403 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -1.20 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:47:56,692 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  1%|█▌                                                                                                      | 3/201 [00:25<27:38,  8.38s/it]2024-08-07 03:47:56,734 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:47:56,735 - INFO - input_ids type: <class 'list'>
2024-08-07 03:47:56,735 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -1.85 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:48:04,819 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  2%|██                                                                                                      | 4/201 [00:33<27:10,  8.28s/it]2024-08-07 03:48:04,860 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:48:04,860 - INFO - input_ids type: <class 'list'>
2024-08-07 03:48:04,860 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -2.63 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:48:12,552 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  2%|██▌                                                                                                     | 5/201 [00:41<26:24,  8.08s/it]2024-08-07 03:48:12,593 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:48:12,594 - INFO - input_ids type: <class 'list'>
2024-08-07 03:48:12,594 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -2.96 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:48:20,759 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  3%|███                                                                                                     | 6/201 [00:49<26:24,  8.12s/it]2024-08-07 03:48:20,800 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:48:20,800 - INFO - input_ids type: <class 'list'>
2024-08-07 03:48:20,800 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -2.37 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:48:28,363 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  3%|███▌                                                                                                    | 7/201 [00:56<25:43,  7.95s/it]2024-08-07 03:48:28,404 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:48:28,404 - INFO - input_ids type: <class 'list'>
2024-08-07 03:48:28,404 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -3.55 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:48:36,598 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  4%|████▏                                                                                                   | 8/201 [01:05<25:52,  8.04s/it]2024-08-07 03:48:36,640 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:48:36,640 - INFO - input_ids type: <class 'list'>
2024-08-07 03:48:36,640 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -3.82 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:48:44,795 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  4%|████▋                                                                                                   | 9/201 [01:13<25:53,  8.09s/it]2024-08-07 03:48:44,835 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:48:44,836 - INFO - input_ids type: <class 'list'>
2024-08-07 03:48:44,836 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.38 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:48:53,034 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  5%|█████                                                                                                  | 10/201 [01:21<25:54,  8.14s/it]2024-08-07 03:48:53,074 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:48:53,075 - INFO - input_ids type: <class 'list'>
2024-08-07 03:48:53,075 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.24 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:49:01,262 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  5%|█████▋                                                                                                 | 11/201 [01:29<25:51,  8.17s/it]2024-08-07 03:49:01,303 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:49:01,303 - INFO - input_ids type: <class 'list'>
2024-08-07 03:49:01,303 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.01 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:49:09,572 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  6%|██████▏                                                                                                | 12/201 [01:38<25:51,  8.21s/it]2024-08-07 03:49:09,615 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:49:09,615 - INFO - input_ids type: <class 'list'>
2024-08-07 03:49:09,615 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.52 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:49:17,831 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  6%|██████▋                                                                                                | 13/201 [01:46<25:46,  8.22s/it]2024-08-07 03:49:17,872 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:49:17,872 - INFO - input_ids type: <class 'list'>
2024-08-07 03:49:17,872 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -2.85 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:49:25,736 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  7%|███████▏                                                                                               | 14/201 [01:54<25:19,  8.13s/it]2024-08-07 03:49:25,777 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:49:25,777 - INFO - input_ids type: <class 'list'>
2024-08-07 03:49:25,777 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.45 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:49:33,988 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  7%|███████▋                                                                                               | 15/201 [02:02<25:18,  8.17s/it]2024-08-07 03:49:34,029 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:49:34,029 - INFO - input_ids type: <class 'list'>
2024-08-07 03:49:34,029 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -3.87 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:49:41,874 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  8%|████████▏                                                                                              | 16/201 [02:10<24:55,  8.08s/it]2024-08-07 03:49:41,915 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:49:41,915 - INFO - input_ids type: <class 'list'>
2024-08-07 03:49:41,915 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.04 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:49:50,085 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  8%|████████▋                                                                                              | 17/201 [02:18<24:54,  8.12s/it]2024-08-07 03:49:50,125 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:49:50,125 - INFO - input_ids type: <class 'list'>
2024-08-07 03:49:50,126 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.81 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:49:58,322 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  9%|█████████▏                                                                                             | 18/201 [02:26<24:52,  8.16s/it]2024-08-07 03:49:58,364 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:49:58,364 - INFO - input_ids type: <class 'list'>
2024-08-07 03:49:58,364 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.87 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:50:06,592 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
  9%|█████████▋                                                                                             | 19/201 [02:35<24:50,  8.19s/it]2024-08-07 03:50:06,633 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:50:06,633 - INFO - input_ids type: <class 'list'>
2024-08-07 03:50:06,633 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.07 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:50:14,792 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 10%|██████████▏                                                                                            | 20/201 [02:43<24:42,  8.19s/it]2024-08-07 03:50:14,832 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:50:14,832 - INFO - input_ids type: <class 'list'>
2024-08-07 03:50:14,832 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.57 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:50:22,989 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 10%|██████████▊                                                                                            | 21/201 [02:51<24:34,  8.19s/it]2024-08-07 03:50:23,029 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:50:23,030 - INFO - input_ids type: <class 'list'>
2024-08-07 03:50:23,030 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.06 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:50:31,179 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 11%|███████████▎                                                                                           | 22/201 [02:59<24:26,  8.19s/it]2024-08-07 03:50:31,219 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:50:31,220 - INFO - input_ids type: <class 'list'>
2024-08-07 03:50:31,220 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.98 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:50:39,407 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 11%|███████████▊                                                                                           | 23/201 [03:07<24:20,  8.20s/it]2024-08-07 03:50:39,449 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:50:39,449 - INFO - input_ids type: <class 'list'>
2024-08-07 03:50:39,449 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -3.91 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:50:47,604 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 12%|████████████▎                                                                                          | 24/201 [03:16<24:11,  8.20s/it]2024-08-07 03:50:47,646 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:50:47,646 - INFO - input_ids type: <class 'list'>
2024-08-07 03:50:47,646 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.36 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:50:55,801 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 12%|████████████▊                                                                                          | 25/201 [03:24<24:03,  8.20s/it]2024-08-07 03:50:55,842 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:50:55,842 - INFO - input_ids type: <class 'list'>
2024-08-07 03:50:55,842 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.98 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:51:03,813 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 13%|█████████████▎                                                                                         | 26/201 [03:32<23:45,  8.14s/it]2024-08-07 03:51:03,853 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:51:03,853 - INFO - input_ids type: <class 'list'>
2024-08-07 03:51:03,853 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.32 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:51:12,110 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 13%|█████████████▊                                                                                         | 27/201 [03:40<23:44,  8.19s/it]2024-08-07 03:51:12,150 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:51:12,150 - INFO - input_ids type: <class 'list'>
2024-08-07 03:51:12,150 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.76 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:51:20,171 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 14%|██████████████▎                                                                                        | 28/201 [03:48<23:30,  8.15s/it]2024-08-07 03:51:20,212 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:51:20,212 - INFO - input_ids type: <class 'list'>
2024-08-07 03:51:20,212 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.01 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:51:27,906 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 14%|██████████████▊                                                                                        | 29/201 [03:56<23:00,  8.03s/it]2024-08-07 03:51:27,946 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:51:27,946 - INFO - input_ids type: <class 'list'>
2024-08-07 03:51:27,946 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.74 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:51:36,115 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 15%|███████████████▎                                                                                       | 30/201 [04:04<23:01,  8.08s/it]2024-08-07 03:51:36,155 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:51:36,156 - INFO - input_ids type: <class 'list'>
2024-08-07 03:51:36,156 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.47 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:51:44,333 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 15%|███████████████▉                                                                                       | 31/201 [04:12<23:00,  8.12s/it]2024-08-07 03:51:44,373 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:51:44,373 - INFO - input_ids type: <class 'list'>
2024-08-07 03:51:44,373 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.30 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:51:52,578 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 16%|████████████████▍                                                                                      | 32/201 [04:21<22:58,  8.16s/it]2024-08-07 03:51:52,618 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:51:52,618 - INFO - input_ids type: <class 'list'>
2024-08-07 03:51:52,618 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.45 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:52:00,802 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 16%|████████████████▉                                                                                      | 33/201 [04:29<22:53,  8.18s/it]2024-08-07 03:52:00,842 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:52:00,843 - INFO - input_ids type: <class 'list'>
2024-08-07 03:52:00,843 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.08 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:52:09,026 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 17%|█████████████████▍                                                                                     | 34/201 [04:37<22:48,  8.19s/it]2024-08-07 03:52:09,067 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:52:09,067 - INFO - input_ids type: <class 'list'>
2024-08-07 03:52:09,067 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.59 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:52:17,235 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 17%|█████████████████▉                                                                                     | 35/201 [04:45<22:40,  8.20s/it]2024-08-07 03:52:17,276 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:52:17,276 - INFO - input_ids type: <class 'list'>
2024-08-07 03:52:17,276 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.22 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:52:25,437 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 18%|██████████████████▍                                                                                    | 36/201 [04:53<22:32,  8.20s/it]2024-08-07 03:52:25,478 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:52:25,479 - INFO - input_ids type: <class 'list'>
2024-08-07 03:52:25,479 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.25 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:52:33,648 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 18%|██████████████████▉                                                                                    | 37/201 [05:02<22:25,  8.20s/it]2024-08-07 03:52:33,688 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:52:33,689 - INFO - input_ids type: <class 'list'>
2024-08-07 03:52:33,689 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -3.77 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:52:41,588 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 19%|███████████████████▍                                                                                   | 38/201 [05:10<22:04,  8.12s/it]2024-08-07 03:52:41,629 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:52:41,629 - INFO - input_ids type: <class 'list'>
2024-08-07 03:52:41,629 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.77 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:52:49,688 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 19%|███████████████████▉                                                                                   | 39/201 [05:18<21:54,  8.12s/it]2024-08-07 03:52:49,728 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:52:49,728 - INFO - input_ids type: <class 'list'>
2024-08-07 03:52:49,728 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.39 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:52:57,771 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 20%|████████████████████▍                                                                                  | 40/201 [05:26<21:45,  8.11s/it]2024-08-07 03:52:57,812 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:52:57,812 - INFO - input_ids type: <class 'list'>
2024-08-07 03:52:57,813 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.56 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:53:06,031 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 20%|█████████████████████                                                                                  | 41/201 [05:34<21:44,  8.15s/it]2024-08-07 03:53:06,071 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:53:06,071 - INFO - input_ids type: <class 'list'>
2024-08-07 03:53:06,071 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.48 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:53:14,248 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 21%|█████████████████████▌                                                                                 | 42/201 [05:42<21:39,  8.17s/it]2024-08-07 03:53:14,289 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:53:14,289 - INFO - input_ids type: <class 'list'>
2024-08-07 03:53:14,289 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.72 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:53:22,384 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 21%|██████████████████████                                                                                 | 43/201 [05:50<21:29,  8.16s/it]2024-08-07 03:53:22,424 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:53:22,424 - INFO - input_ids type: <class 'list'>
2024-08-07 03:53:22,424 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.83 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:53:30,596 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 22%|██████████████████████▌                                                                                | 44/201 [05:59<21:23,  8.18s/it]2024-08-07 03:53:30,636 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:53:30,637 - INFO - input_ids type: <class 'list'>
2024-08-07 03:53:30,637 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.19 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:53:38,794 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 22%|███████████████████████                                                                                | 45/201 [06:07<21:16,  8.18s/it]2024-08-07 03:53:38,835 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:53:38,835 - INFO - input_ids type: <class 'list'>
2024-08-07 03:53:38,835 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.73 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:53:46,963 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 23%|███████████████████████▌                                                                               | 46/201 [06:15<21:07,  8.18s/it]2024-08-07 03:53:47,004 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:53:47,004 - INFO - input_ids type: <class 'list'>
2024-08-07 03:53:47,004 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.64 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:53:55,188 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 23%|████████████████████████                                                                               | 47/201 [06:23<21:02,  8.20s/it]2024-08-07 03:53:55,247 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:53:55,247 - INFO - input_ids type: <class 'list'>
2024-08-07 03:53:55,247 - INFO - input_ids shape: torch.Size([7])
2024-08-07 03:54:03,003 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 24%|████████████████████████▌                                                                              | 48/201 [06:31<20:35,  8.08s/it]2024-08-07 03:54:03,043 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:54:03,044 - INFO - input_ids type: <class 'list'>
2024-08-07 03:54:03,044 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.94 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:54:10,705 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 24%|█████████████████████████                                                                              | 49/201 [06:39<20:10,  7.96s/it]2024-08-07 03:54:10,745 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:54:10,745 - INFO - input_ids type: <class 'list'>
2024-08-07 03:54:10,745 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.27 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:54:18,928 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 25%|█████████████████████████▌                                                                             | 50/201 [06:47<20:14,  8.04s/it]2024-08-07 03:54:18,969 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:54:18,969 - INFO - input_ids type: <class 'list'>
2024-08-07 03:54:18,969 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.27 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:54:27,180 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 25%|██████████████████████████▏                                                                            | 51/201 [06:55<20:15,  8.11s/it]2024-08-07 03:54:27,221 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:54:27,221 - INFO - input_ids type: <class 'list'>
2024-08-07 03:54:27,221 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.33 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:54:35,287 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 26%|██████████████████████████▋                                                                            | 52/201 [07:03<20:07,  8.11s/it]2024-08-07 03:54:35,327 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:54:35,327 - INFO - input_ids type: <class 'list'>
2024-08-07 03:54:35,327 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.42 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:54:43,661 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 26%|███████████████████████████▏                                                                           | 53/201 [07:12<20:11,  8.19s/it]2024-08-07 03:54:43,708 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:54:43,708 - INFO - input_ids type: <class 'list'>
2024-08-07 03:54:43,708 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.65 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:54:51,885 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 27%|███████████████████████████▋                                                                           | 54/201 [07:20<20:04,  8.20s/it]2024-08-07 03:54:51,925 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:54:51,926 - INFO - input_ids type: <class 'list'>
2024-08-07 03:54:51,926 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.40 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:55:00,109 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 27%|████████████████████████████▏                                                                          | 55/201 [07:28<19:57,  8.21s/it]2024-08-07 03:55:00,149 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:55:00,149 - INFO - input_ids type: <class 'list'>
2024-08-07 03:55:00,149 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.39 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:55:08,307 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 28%|████████████████████████████▋                                                                          | 56/201 [07:36<19:49,  8.20s/it]2024-08-07 03:55:08,347 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:55:08,348 - INFO - input_ids type: <class 'list'>
2024-08-07 03:55:08,348 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.03 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:55:16,509 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 28%|█████████████████████████████▏                                                                         | 57/201 [07:45<19:41,  8.20s/it]2024-08-07 03:55:16,549 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:55:16,550 - INFO - input_ids type: <class 'list'>
2024-08-07 03:55:16,550 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.04 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:55:24,745 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 29%|█████████████████████████████▋                                                                         | 58/201 [07:53<19:34,  8.21s/it]2024-08-07 03:55:24,786 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:55:24,786 - INFO - input_ids type: <class 'list'>
2024-08-07 03:55:24,786 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.77 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:55:32,948 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 29%|██████████████████████████████▏                                                                        | 59/201 [08:01<19:25,  8.21s/it]2024-08-07 03:55:32,988 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:55:32,988 - INFO - input_ids type: <class 'list'>
2024-08-07 03:55:32,988 - INFO - input_ids shape: torch.Size([7])
2024-08-07 03:55:41,149 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 30%|██████████████████████████████▋                                                                        | 60/201 [08:09<19:17,  8.21s/it]2024-08-07 03:55:41,188 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:55:41,189 - INFO - input_ids type: <class 'list'>
2024-08-07 03:55:41,189 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.46 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:55:49,480 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 30%|███████████████████████████████▎                                                                       | 61/201 [08:18<19:14,  8.25s/it]2024-08-07 03:55:49,523 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:55:49,523 - INFO - input_ids type: <class 'list'>
2024-08-07 03:55:49,523 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.42 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:55:57,783 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 31%|███████████████████████████████▊                                                                       | 62/201 [08:26<19:08,  8.26s/it]2024-08-07 03:55:57,823 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:55:57,823 - INFO - input_ids type: <class 'list'>
2024-08-07 03:55:57,823 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -10.71 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:56:06,055 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 31%|████████████████████████████████▎                                                                      | 63/201 [08:34<19:00,  8.26s/it]2024-08-07 03:56:06,096 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:56:06,096 - INFO - input_ids type: <class 'list'>
2024-08-07 03:56:06,096 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.87 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:56:14,287 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 32%|████████████████████████████████▊                                                                      | 64/201 [08:42<18:50,  8.26s/it]2024-08-07 03:56:14,327 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:56:14,328 - INFO - input_ids type: <class 'list'>
2024-08-07 03:56:14,328 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.67 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:56:22,500 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 32%|█████████████████████████████████▎                                                                     | 65/201 [08:51<18:40,  8.24s/it]2024-08-07 03:56:22,542 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:56:22,542 - INFO - input_ids type: <class 'list'>
2024-08-07 03:56:22,542 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.96 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:56:30,684 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 33%|█████████████████████████████████▊                                                                     | 66/201 [08:59<18:30,  8.22s/it]2024-08-07 03:56:30,724 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:56:30,724 - INFO - input_ids type: <class 'list'>
2024-08-07 03:56:30,724 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.51 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:56:38,890 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 33%|██████████████████████████████████▎                                                                    | 67/201 [09:07<18:21,  8.22s/it]2024-08-07 03:56:38,930 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:56:38,931 - INFO - input_ids type: <class 'list'>
2024-08-07 03:56:38,931 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.88 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:56:46,993 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 34%|██████████████████████████████████▊                                                                    | 68/201 [09:15<18:08,  8.18s/it]2024-08-07 03:56:47,033 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:56:47,033 - INFO - input_ids type: <class 'list'>
2024-08-07 03:56:47,033 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.60 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:56:55,211 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 34%|███████████████████████████████████▎                                                                   | 69/201 [09:23<18:01,  8.19s/it]2024-08-07 03:56:55,251 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:56:55,251 - INFO - input_ids type: <class 'list'>
2024-08-07 03:56:55,251 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.08 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:57:03,396 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 35%|███████████████████████████████████▊                                                                   | 70/201 [09:31<17:53,  8.19s/it]2024-08-07 03:57:03,436 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:57:03,436 - INFO - input_ids type: <class 'list'>
2024-08-07 03:57:03,436 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.65 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:57:11,601 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 35%|████████████████████████████████████▍                                                                  | 71/201 [09:40<17:45,  8.20s/it]2024-08-07 03:57:11,643 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:57:11,644 - INFO - input_ids type: <class 'list'>
2024-08-07 03:57:11,644 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -11.58 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:57:19,795 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 36%|████████████████████████████████████▉                                                                  | 72/201 [09:48<17:37,  8.20s/it]2024-08-07 03:57:19,836 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:57:19,836 - INFO - input_ids type: <class 'list'>
2024-08-07 03:57:19,836 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.94 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:57:28,030 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 36%|█████████████████████████████████████▍                                                                 | 73/201 [09:56<17:30,  8.21s/it]2024-08-07 03:57:28,070 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:57:28,070 - INFO - input_ids type: <class 'list'>
2024-08-07 03:57:28,071 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.51 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:57:36,065 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 37%|█████████████████████████████████████▉                                                                 | 74/201 [10:04<17:15,  8.16s/it]2024-08-07 03:57:36,105 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:57:36,105 - INFO - input_ids type: <class 'list'>
2024-08-07 03:57:36,105 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.02 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:57:44,282 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 37%|██████████████████████████████████████▍                                                                | 75/201 [10:12<17:09,  8.17s/it]2024-08-07 03:57:44,322 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:57:44,322 - INFO - input_ids type: <class 'list'>
2024-08-07 03:57:44,322 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.39 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:57:52,499 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 38%|██████████████████████████████████████▉                                                                | 76/201 [10:21<17:03,  8.19s/it]2024-08-07 03:57:52,540 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:57:52,540 - INFO - input_ids type: <class 'list'>
2024-08-07 03:57:52,540 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.44 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:58:00,617 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 38%|███████████████████████████████████████▍                                                               | 77/201 [10:29<16:52,  8.17s/it]2024-08-07 03:58:00,657 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:58:00,657 - INFO - input_ids type: <class 'list'>
2024-08-07 03:58:00,657 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.64 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:58:08,196 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 39%|███████████████████████████████████████▉                                                               | 78/201 [10:36<16:22,  7.99s/it]2024-08-07 03:58:08,236 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:58:08,236 - INFO - input_ids type: <class 'list'>
2024-08-07 03:58:08,236 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.32 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:58:16,431 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 39%|████████████████████████████████████████▍                                                              | 79/201 [10:44<16:23,  8.06s/it]2024-08-07 03:58:16,471 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:58:16,471 - INFO - input_ids type: <class 'list'>
2024-08-07 03:58:16,471 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.73 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:58:24,629 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 40%|████████████████████████████████████████▉                                                              | 80/201 [10:53<16:20,  8.10s/it]2024-08-07 03:58:24,669 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:58:24,669 - INFO - input_ids type: <class 'list'>
2024-08-07 03:58:24,669 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.32 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:58:32,819 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 40%|█████████████████████████████████████████▌                                                             | 81/201 [11:01<16:15,  8.13s/it]2024-08-07 03:58:32,859 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:58:32,860 - INFO - input_ids type: <class 'list'>
2024-08-07 03:58:32,860 - INFO - input_ids shape: torch.Size([8])
2024-08-07 03:58:41,313 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 41%|██████████████████████████████████████████                                                             | 82/201 [11:09<16:20,  8.24s/it]2024-08-07 03:58:41,355 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:58:41,356 - INFO - input_ids type: <class 'list'>
2024-08-07 03:58:41,356 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.02 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:58:49,649 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 41%|██████████████████████████████████████████▌                                                            | 83/201 [11:18<16:15,  8.27s/it]2024-08-07 03:58:49,689 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:58:49,690 - INFO - input_ids type: <class 'list'>
2024-08-07 03:58:49,690 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -10.35 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:58:57,879 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 42%|███████████████████████████████████████████                                                            | 84/201 [11:26<16:06,  8.26s/it]2024-08-07 03:58:57,920 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:58:57,920 - INFO - input_ids type: <class 'list'>
2024-08-07 03:58:57,920 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.62 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:59:06,177 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 42%|███████████████████████████████████████████▌                                                           | 85/201 [11:34<15:59,  8.27s/it]2024-08-07 03:59:06,217 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:59:06,217 - INFO - input_ids type: <class 'list'>
2024-08-07 03:59:06,217 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.57 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:59:14,386 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 43%|████████████████████████████████████████████                                                           | 86/201 [11:42<15:48,  8.25s/it]2024-08-07 03:59:14,426 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:59:14,426 - INFO - input_ids type: <class 'list'>
2024-08-07 03:59:14,426 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.43 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:59:22,615 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 43%|████████████████████████████████████████████▌                                                          | 87/201 [11:51<15:39,  8.24s/it]2024-08-07 03:59:22,657 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:59:22,657 - INFO - input_ids type: <class 'list'>
2024-08-07 03:59:22,657 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.32 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:59:30,843 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 44%|█████████████████████████████████████████████                                                          | 88/201 [11:59<15:31,  8.24s/it]2024-08-07 03:59:30,884 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:59:30,884 - INFO - input_ids type: <class 'list'>
2024-08-07 03:59:30,884 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.13 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:59:39,034 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 44%|█████████████████████████████████████████████▌                                                         | 89/201 [12:07<15:21,  8.22s/it]2024-08-07 03:59:39,074 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:59:39,074 - INFO - input_ids type: <class 'list'>
2024-08-07 03:59:39,074 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.04 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:59:47,205 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 45%|██████████████████████████████████████████████                                                         | 90/201 [12:15<15:11,  8.21s/it]2024-08-07 03:59:47,246 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:59:47,246 - INFO - input_ids type: <class 'list'>
2024-08-07 03:59:47,246 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.83 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 03:59:55,389 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 45%|██████████████████████████████████████████████▋                                                        | 91/201 [12:23<15:02,  8.20s/it]2024-08-07 03:59:55,430 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 03:59:55,430 - INFO - input_ids type: <class 'list'>
2024-08-07 03:59:55,430 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.68 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:00:03,554 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 46%|███████████████████████████████████████████████▏                                                       | 92/201 [12:32<14:52,  8.19s/it]2024-08-07 04:00:03,595 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:00:03,595 - INFO - input_ids type: <class 'list'>
2024-08-07 04:00:03,596 - INFO - input_ids shape: torch.Size([8])
2024-08-07 04:00:11,761 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 46%|███████████████████████████████████████████████▋                                                       | 93/201 [12:40<14:45,  8.20s/it]2024-08-07 04:00:11,801 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:00:11,801 - INFO - input_ids type: <class 'list'>
2024-08-07 04:00:11,802 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.36 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:00:19,955 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 47%|████████████████████████████████████████████████▏                                                      | 94/201 [12:48<14:36,  8.19s/it]2024-08-07 04:00:19,995 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:00:19,995 - INFO - input_ids type: <class 'list'>
2024-08-07 04:00:19,995 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.63 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:00:28,157 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 47%|████████████████████████████████████████████████▋                                                      | 95/201 [12:56<14:28,  8.20s/it]2024-08-07 04:00:28,198 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:00:28,198 - INFO - input_ids type: <class 'list'>
2024-08-07 04:00:28,198 - INFO - input_ids shape: torch.Size([8])
2024-08-07 04:00:35,916 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 48%|█████████████████████████████████████████████████▏                                                     | 96/201 [13:04<14:06,  8.07s/it]2024-08-07 04:00:35,956 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:00:35,957 - INFO - input_ids type: <class 'list'>
2024-08-07 04:00:35,957 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -10.21 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:00:44,117 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 48%|█████████████████████████████████████████████████▋                                                     | 97/201 [13:12<14:03,  8.11s/it]2024-08-07 04:00:44,158 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:00:44,158 - INFO - input_ids type: <class 'list'>
2024-08-07 04:00:44,158 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.53 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:00:52,591 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 49%|██████████████████████████████████████████████████▏                                                    | 98/201 [13:21<14:06,  8.22s/it]2024-08-07 04:00:52,633 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:00:52,633 - INFO - input_ids type: <class 'list'>
2024-08-07 04:00:52,633 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.90 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:01:00,848 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 49%|██████████████████████████████████████████████████▋                                                    | 99/201 [13:29<13:59,  8.23s/it]2024-08-07 04:01:00,888 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:01:00,888 - INFO - input_ids type: <class 'list'>
2024-08-07 04:01:00,888 - INFO - input_ids shape: torch.Size([6])
2024-08-07 04:01:09,038 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 50%|██████████████████████████████████████████████████▋                                                   | 100/201 [13:37<13:49,  8.22s/it]2024-08-07 04:01:09,078 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:01:09,079 - INFO - input_ids type: <class 'list'>
2024-08-07 04:01:09,079 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.66 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:01:17,257 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 50%|███████████████████████████████████████████████████▎                                                  | 101/201 [13:45<13:41,  8.22s/it]2024-08-07 04:01:17,297 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:01:17,297 - INFO - input_ids type: <class 'list'>
2024-08-07 04:01:17,297 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -10.46 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:01:25,433 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 51%|███████████████████████████████████████████████████▊                                                  | 102/201 [13:53<13:32,  8.21s/it]2024-08-07 04:01:25,474 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:01:25,474 - INFO - input_ids type: <class 'list'>
2024-08-07 04:01:25,474 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.92 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:01:33,647 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 51%|████████████████████████████████████████████████████▎                                                 | 103/201 [14:02<13:24,  8.21s/it]2024-08-07 04:01:33,690 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:01:33,690 - INFO - input_ids type: <class 'list'>
2024-08-07 04:01:33,690 - INFO - input_ids shape: torch.Size([6])
2024-08-07 04:01:42,098 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 52%|████████████████████████████████████████████████████▊                                                 | 104/201 [14:10<13:23,  8.28s/it]2024-08-07 04:01:42,140 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:01:42,140 - INFO - input_ids type: <class 'list'>
2024-08-07 04:01:42,140 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -12.80 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:01:50,572 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 52%|█████████████████████████████████████████████████████▎                                                | 105/201 [14:19<13:20,  8.34s/it]2024-08-07 04:01:50,613 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:01:50,613 - INFO - input_ids type: <class 'list'>
2024-08-07 04:01:50,614 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.36 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:01:58,901 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 53%|█████████████████████████████████████████████████████▊                                                | 106/201 [14:27<13:11,  8.34s/it]2024-08-07 04:01:58,941 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:01:58,941 - INFO - input_ids type: <class 'list'>
2024-08-07 04:01:58,941 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.81 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:02:07,371 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 53%|██████████████████████████████████████████████████████▎                                               | 107/201 [14:35<13:07,  8.38s/it]2024-08-07 04:02:07,413 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:02:07,413 - INFO - input_ids type: <class 'list'>
2024-08-07 04:02:07,413 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.97 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:02:15,992 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 54%|██████████████████████████████████████████████████████▊                                               | 108/201 [14:44<13:05,  8.45s/it]2024-08-07 04:02:16,033 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:02:16,033 - INFO - input_ids type: <class 'list'>
2024-08-07 04:02:16,033 - INFO - input_ids shape: torch.Size([10])
2024-08-07 04:02:24,227 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 54%|███████████████████████████████████████████████████████▎                                              | 109/201 [14:52<12:51,  8.38s/it]2024-08-07 04:02:24,267 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:02:24,267 - INFO - input_ids type: <class 'list'>
2024-08-07 04:02:24,267 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.25 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:02:32,416 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 55%|███████████████████████████████████████████████████████▊                                              | 110/201 [15:00<12:37,  8.33s/it]2024-08-07 04:02:32,457 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:02:32,457 - INFO - input_ids type: <class 'list'>
2024-08-07 04:02:32,457 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.60 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:02:40,583 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 55%|████████████████████████████████████████████████████████▎                                             | 111/201 [15:09<12:25,  8.28s/it]2024-08-07 04:02:40,623 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:02:40,623 - INFO - input_ids type: <class 'list'>
2024-08-07 04:02:40,623 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.91 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:02:48,588 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 56%|████████████████████████████████████████████████████████▊                                             | 112/201 [15:17<12:09,  8.20s/it]2024-08-07 04:02:48,628 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:02:48,628 - INFO - input_ids type: <class 'list'>
2024-08-07 04:02:48,628 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.78 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:02:56,784 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 56%|█████████████████████████████████████████████████████████▎                                            | 113/201 [15:25<12:01,  8.20s/it]2024-08-07 04:02:56,825 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:02:56,825 - INFO - input_ids type: <class 'list'>
2024-08-07 04:02:56,825 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.30 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:03:04,979 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 57%|█████████████████████████████████████████████████████████▊                                            | 114/201 [15:33<11:53,  8.20s/it]2024-08-07 04:03:05,019 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:03:05,020 - INFO - input_ids type: <class 'list'>
2024-08-07 04:03:05,020 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.71 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:03:13,191 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 57%|██████████████████████████████████████████████████████████▎                                           | 115/201 [15:41<11:45,  8.20s/it]2024-08-07 04:03:13,231 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:03:13,231 - INFO - input_ids type: <class 'list'>
2024-08-07 04:03:13,232 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -6.61 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:03:21,400 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 58%|██████████████████████████████████████████████████████████▊                                           | 116/201 [15:49<11:37,  8.20s/it]2024-08-07 04:03:21,440 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:03:21,440 - INFO - input_ids type: <class 'list'>
2024-08-07 04:03:21,440 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.97 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:03:29,637 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 58%|███████████████████████████████████████████████████████████▎                                          | 117/201 [15:58<11:29,  8.21s/it]2024-08-07 04:03:29,678 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:03:29,678 - INFO - input_ids type: <class 'list'>
2024-08-07 04:03:29,678 - INFO - input_ids shape: torch.Size([8])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -9.98 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:03:37,801 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 59%|███████████████████████████████████████████████████████████▉                                          | 118/201 [16:06<11:20,  8.20s/it]2024-08-07 04:03:37,841 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:03:37,841 - INFO - input_ids type: <class 'list'>
2024-08-07 04:03:37,841 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -4.71 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:03:45,988 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 59%|████████████████████████████████████████████████████████████▍                                         | 119/201 [16:14<11:11,  8.19s/it]2024-08-07 04:03:46,027 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:03:46,027 - INFO - input_ids type: <class 'list'>
2024-08-07 04:03:46,028 - INFO - input_ids shape: torch.Size([6])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -7.64 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:03:54,235 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 60%|████████████████████████████████████████████████████████████▉                                         | 120/201 [16:22<11:05,  8.21s/it]2024-08-07 04:03:54,275 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:03:54,276 - INFO - input_ids type: <class 'list'>
2024-08-07 04:03:54,276 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -10.29 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:04:02,441 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 60%|█████████████████████████████████████████████████████████████▍                                        | 121/201 [16:31<10:56,  8.21s/it]2024-08-07 04:04:02,482 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:04:02,482 - INFO - input_ids type: <class 'list'>
2024-08-07 04:04:02,482 - INFO - input_ids shape: torch.Size([11])
2024-08-07 04:04:10,598 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 61%|█████████████████████████████████████████████████████████████▉                                        | 122/201 [16:39<10:47,  8.19s/it]2024-08-07 04:04:10,638 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:04:10,638 - INFO - input_ids type: <class 'list'>
2024-08-07 04:04:10,638 - INFO - input_ids shape: torch.Size([11])
2024-08-07 04:04:18,738 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 61%|██████████████████████████████████████████████████████████████▍                                       | 123/201 [16:47<10:37,  8.18s/it]2024-08-07 04:04:18,779 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:04:18,779 - INFO - input_ids type: <class 'list'>
2024-08-07 04:04:18,779 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -13.95 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:04:26,939 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 62%|██████████████████████████████████████████████████████████████▉                                       | 124/201 [16:55<10:30,  8.18s/it]2024-08-07 04:04:26,980 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:04:26,980 - INFO - input_ids type: <class 'list'>
2024-08-07 04:04:26,980 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -12.09 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:04:35,145 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 62%|███████████████████████████████████████████████████████████████▍                                      | 125/201 [17:03<10:22,  8.19s/it]2024-08-07 04:04:35,185 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:04:35,185 - INFO - input_ids type: <class 'list'>
2024-08-07 04:04:35,185 - INFO - input_ids shape: torch.Size([9])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.49 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:04:43,320 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 63%|███████████████████████████████████████████████████████████████▉                                      | 126/201 [17:11<10:13,  8.19s/it]2024-08-07 04:04:43,360 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:04:43,361 - INFO - input_ids type: <class 'list'>
2024-08-07 04:04:43,361 - INFO - input_ids shape: torch.Size([11])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -5.40 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:04:51,502 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 63%|████████████████████████████████████████████████████████████████▍                                     | 127/201 [17:20<10:05,  8.18s/it]2024-08-07 04:04:51,542 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:04:51,542 - INFO - input_ids type: <class 'list'>
2024-08-07 04:04:51,542 - INFO - input_ids shape: torch.Size([10])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.85 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:04:59,703 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 64%|████████████████████████████████████████████████████████████████▉                                     | 128/201 [17:28<09:57,  8.19s/it]2024-08-07 04:04:59,744 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:04:59,744 - INFO - input_ids type: <class 'list'>
2024-08-07 04:04:59,744 - INFO - input_ids shape: torch.Size([7])
/usr/local/lib/python3.10/dist-packages/trl/trainer/ppo_trainer.py:1304: UserWarning: KL divergence is starting to become negative: -8.54 - this might be a precursor for failed training. sometimes this happens because the generation kwargs are not correctly set. Please make sure that the generation kwargs are set correctly, or review your training hyperparameters.
  warnings.warn(
2024-08-07 04:05:07,911 - INFO - Epoch 0, Batch completed. Average reward: 1.0000
 64%|█████████████████████████████████████████████████████████████████▍                                    | 129/201 [17:36<09:50,  8.20s/it]2024-08-07 04:05:07,951 - INFO - Batch keys: dict_keys(['input_ids', 'query', 'label'])
2024-08-07 04:05:07,951 - INFO - input_ids type: <class 'list'>
2024-08-07 04:05:07,951 - INFO - input_ids shape: torch.Size([11])
 64%|█████████████████████████████████████████████████████████████████▍                                    | 129/201 [17:40<09:51,  8.22s/it]
Traceback (most recent call last):
  File "/root/collaborative-stegosystem/simple_test/3test.py", line 205, in <module>
    config,
  File "/root/collaborative-stegosystem/simple_test/3test.py", line 206, in <listcomp>
    model=model,
  File "/root/collaborative-stegosystem/simple_test/3test.py", line 129, in generate_alice_message
    outputs = model.generate(
  File "/usr/local/lib/python3.10/dist-packages/trl/models/modeling_value_head.py", line 209, in generate
    return self.pretrained_model.generate(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/generation/utils.py", line 2024, in generate
    result = self._sample(
  File "/usr/local/lib/python3.10/dist-packages/transformers/generation/utils.py", line 2982, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py", line 1189, in forward
    outputs = self.model(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py", line 1001, in forward
    layer_outputs = decoder_layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py", line 734, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py", line 635, in forward
    query_states, key_states = apply_rotary_pos_emb(query_states, key_states, cos, sin)
  File "/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py", line 275, in apply_rotary_pos_emb
    q_embed = (q * cos) + (rotate_half(q) * sin)
  File "/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py", line 250, in rotate_half
    return torch.cat((-x2, x1), dim=-1)
KeyboardInterrupt