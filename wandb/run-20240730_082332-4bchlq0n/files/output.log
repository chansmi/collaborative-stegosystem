State tensor shape: torch.Size([1, 301])
Warning: No data for MSFT on 1980-12-12 00:00:00
Warning: No data for AMZN on 1980-12-12 00:00:00
Warning: No data for FB on 1980-12-12 00:00:00
Warning: No data for GOOGL on 1980-12-12 00:00:00
Warning: No data for GOOG on 1980-12-12 00:00:00
Warning: No data for TSLA on 1980-12-12 00:00:00
Warning: No data for UPS on 1980-12-12 00:00:00
Warning: No data for NVDA on 1980-12-12 00:00:00
Warning: No data for UNH on 1980-12-12 00:00:00
Warning: No data for HD on 1980-12-12 00:00:00
Warning: No data for V on 1980-12-12 00:00:00
Warning: No data for PYPL on 1980-12-12 00:00:00
Warning: No data for MA on 1980-12-12 00:00:00
Warning: No data for NFLX on 1980-12-12 00:00:00
Warning: No data for VZ on 1980-12-12 00:00:00
Warning: No data for ADBE on 1980-12-12 00:00:00
Warning: No data for T on 1980-12-12 00:00:00
Warning: No data for CSCO on 1980-12-12 00:00:00
Warning: No data for ABBV on 1980-12-12 00:00:00
Warning: No data for CRM on 1980-12-12 00:00:00
Warning: No data for ACN on 1980-12-12 00:00:00
Warning: No data for AVGO on 1980-12-12 00:00:00
Warning: No data for QCOM on 1980-12-12 00:00:00
Warning: No data for AMGN on 1980-12-12 00:00:00
Warning: No data for COST on 1980-12-12 00:00:00
Warning: No data for MSFT on 1980-12-12 00:00:00
Warning: No data for AMZN on 1980-12-12 00:00:00
Warning: No data for FB on 1980-12-12 00:00:00
Warning: No data for GOOGL on 1980-12-12 00:00:00
Warning: No data for GOOG on 1980-12-12 00:00:00
Warning: No data for TSLA on 1980-12-12 00:00:00
Warning: No data for UPS on 1980-12-12 00:00:00
Warning: No data for NVDA on 1980-12-12 00:00:00
Warning: No data for UNH on 1980-12-12 00:00:00
Warning: No data for HD on 1980-12-12 00:00:00
Warning: No data for V on 1980-12-12 00:00:00
Warning: No data for PYPL on 1980-12-12 00:00:00
Warning: No data for MA on 1980-12-12 00:00:00
Warning: No data for NFLX on 1980-12-12 00:00:00
Warning: No data for VZ on 1980-12-12 00:00:00
Warning: No data for ADBE on 1980-12-12 00:00:00
Warning: No data for T on 1980-12-12 00:00:00
Warning: No data for CSCO on 1980-12-12 00:00:00
Warning: No data for ABBV on 1980-12-12 00:00:00
Warning: No data for CRM on 1980-12-12 00:00:00
Warning: No data for ACN on 1980-12-12 00:00:00
Warning: No data for AVGO on 1980-12-12 00:00:00
Warning: No data for QCOM on 1980-12-12 00:00:00
Warning: No data for AMGN on 1980-12-12 00:00:00
Warning: No data for COST on 1980-12-12 00:00:00
Warning: No data for MSFT on 1980-12-12 00:00:00
Warning: No data for AMZN on 1980-12-12 00:00:00
Warning: No data for FB on 1980-12-12 00:00:00
Warning: No data for GOOGL on 1980-12-12 00:00:00
Warning: No data for GOOG on 1980-12-12 00:00:00
Warning: No data for TSLA on 1980-12-12 00:00:00
Warning: No data for UPS on 1980-12-12 00:00:00
Warning: No data for NVDA on 1980-12-12 00:00:00
Warning: No data for UNH on 1980-12-12 00:00:00
Warning: No data for HD on 1980-12-12 00:00:00
Warning: No data for V on 1980-12-12 00:00:00
Warning: No data for PYPL on 1980-12-12 00:00:00
Warning: No data for MA on 1980-12-12 00:00:00
Warning: No data for NFLX on 1980-12-12 00:00:00
Warning: No data for VZ on 1980-12-12 00:00:00
Warning: No data for ADBE on 1980-12-12 00:00:00
Warning: No data for T on 1980-12-12 00:00:00
Warning: No data for CSCO on 1980-12-12 00:00:00
Warning: No data for ABBV on 1980-12-12 00:00:00
Warning: No data for CRM on 1980-12-12 00:00:00
Warning: No data for ACN on 1980-12-12 00:00:00
Warning: No data for AVGO on 1980-12-12 00:00:00
Warning: No data for QCOM on 1980-12-12 00:00:00
Warning: No data for AMGN on 1980-12-12 00:00:00
Warning: No data for COST on 1980-12-12 00:00:00
An unexpected error occurred: list indices must be integers or slices, not str
Traceback:
Traceback (most recent call last):
  File "/Users/chansmi/Documents/GitHub/collaborative-stegosystem/src/main.py", line 30, in main
    trainer.train(num_episodes=config['num_episodes'])
  File "/Users/chansmi/Documents/GitHub/collaborative-stegosystem/src/trainers/ppo_trainer.py", line 162, in train
    next_state, reward, done, _ = self.env.step(actions)
                                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chansmi/Documents/GitHub/collaborative-stegosystem/src/environments/stock_market_environment.py", line 90, in step
    reward = self._calculate_reward(new_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chansmi/Documents/GitHub/collaborative-stegosystem/src/environments/stock_market_environment.py", line 131, in _calculate_reward
    price = state['market_data'][state['market_data']['Ticker'] == company]['Close'].values[0]
                                 ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: list indices must be integers or slices, not str