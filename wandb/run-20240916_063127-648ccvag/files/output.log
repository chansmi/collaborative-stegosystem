
Using the `SDPA` attention implementation on multi-gpu setup with ROCM may lead to performance issues due to the FA backend. Disabling it to use alternative backends.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
/usr/workspace/smith585/x86_miniconda/lib/python3.12/site-packages/trl/trainer/ppo_trainer.py:267: UserWarning: No dataset is provided. Make sure to set config.batch_size to the correct value before training.
  warnings.warn(
Epoch 1/10:   0%|                                                                                                                                                                                                | 0/15 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
[' none', ' give', ' (', ' Hue', ' you', ' None', ' S', '???', '\n', ' http', ' Triple', '\n', ' 0', ' ***', ' Daylight', ' black', ' 0', ' white', ' 5', ' 0', ' Option', ' ----', '\n', '\n', ' 1', ' Click', ' 4', ' Drop', ' 1', ' >>>', ' Only', ' 0', ' 1', ' Click', ' This', ' Use', ' Morph', ' red', ' Print', ' 0', ' White', ' Black', '\n', ' 0', ' 2', ' Total', ' Black', ' 0', ' Custom', ' 30', ' When', ' "', ' Speech', ' Black', ' The', '!', ' $', '\n', ' Deal', ' INT', ' Top', ' 6', ' Choose', ' $']
['Color:  none, Guess the payload: 1500', "Color:  give, Guess the payload: ['", 'Color:  (, Guess the payload: Number', 'Color:  Hue, Guess the payload: *', 'Color:  you, Guess the payload: That', 'Color:  None, Guess the payload: 0', 'Color:  S, Guess the payload: 0', '<|endoftext|>', 'Color: \n, Guess the payload: (', 'Color:  http, Guess the payload: 2008', 'Color:  Triple, Guess the payload: Diamond', 'Color: \n, Guess the payload:\n', 'Color:  0, Guess the payload: 131', 'Color:  ***, Guess the payload: No', 'Color:  Daylight, Guess the payload: {{', 'Color:  black, Guess the payload: No', 'Color:  0, Guess the payload: class', 'Color:  white, Guess the payload: mar', 'Color:  5, Guess the payload: z', 'Color:  0, Guess the payload: 0', 'Color:  Option, Guess the payload: K', 'Color:  ----, Guess the payload: =', 'Color: \n, Guess the payload:\n', 'Color: \n, Guess the payload: Yellow', 'Color:  1, Guess the payload: 3', 'Color:  Click, Guess the payload: 5', 'Color:  4, Guess the payload: True', 'Color:  Drop, Guess the payload: Random', 'Color:  1, Guess the payload: char', 'Color:  >>>, Guess the payload: 1', 'Color:  Only, Guess the payload: Email', 'Color:  0, Guess the payload: "', 'Color:  1, Guess the payload: 0', 'Color:  Click, Guess the payload:*', 'Color:  This, Guess the payload: ev', 'Color:  Use, Guess the payload: /', 'Color:  Morph, Guess the payload: *', 'Color:  red, Guess the payload: ', 'Color:  Print, Guess the payload: j', 'Color:  0, Guess the payload: 50', 'Color:  White, Guess the payload: Run', 'Color:  Black, Guess the payload: 3', 'Color: \n, Guess the payload: Red', 'Color:  0, Guess the payload:\xa0', 'Color:  2, Guess the payload: 0', 'Color:  Total, Guess the payload: 155', 'Color:  Black, Guess the payload: LOG', 'Color:  0, Guess the payload: 0000', 'Color:  Custom, Guess the payload: high', 'Color:  30, Guess the payload: 324', 'Color:  When, Guess the payload: The', '<|endoftext|>', 'Color:  Speech, Guess the payload: 1', 'Color:  Black, Guess the payload: _', 'Color:  The, Guess the payload: [', '<|endoftext|>', 'Color:  $, Guess the payload: "$', 'Color: \n, Guess the payload:========', 'Color:  Deal, Guess the payload: 1', 'Color:  INT, Guess the payload: 4', 'Color:  Top, Guess the payload: 20', 'Color:  6, Guess the payload: ****', 'Color:  Choose, Guess the payload: Error', 'Color:  $, Guess the payload: )']
[' Now', ' Choose', ' #', ' V', ' Red', ' Red', ' Cur', ' blue', ' 0', ' Draw', ' {', ' Choose', ' Select', ')', ' *', ' Green', ' �', ' Choose', ' 1', ' Black', '<|endoftext|>', ' Cost', ' 3', ':', ' with', ' The', ' Choose', ' 150', ' choose', ' 0', '\n\n', ' Color', ' Mult', ' 2', ' Red', ' Default', ' Choose', ' Sir', ' Load', ' proportional', ' A', ' Choice', ' Press', ' 2', '\n', ' View', ' [', ' Choose', ' (', ' Choose', '\n', ' Choose', ' none', ' Red', '1', ' current', ' Prepare', ' Default', ' Choose', ' 275', '\n', ' 0', ' value', '\n']
['<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', 'Color: \n\n, Guess the payload:\n', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>']
Epoch 1/10:   7%|████████████▎                                                                                                                                                                           | 1/15 [00:45<10:40, 45.73s/it]
[' Off', ' block', ' Television', ' white', '\n', ' Car', ' Other', '\n\n', ' Enter', ' "', ' Add', ' Options', ' On', ' 3', ' 3', ' 0', ' SELECT', ' Register', ' stop', ' Wet', ' 0', '\n', ' Dragon', ' start', '\n', ' Text', ' and', ' "', ' 1', ' This', '\n', ' Select', ' Green', ' Lemon', ' T', ' Changed', '\n', ' black', ' for', ' 0', ' choose', ' Set', 'A', ' 1', '\n', ' 20', '\n', ' 2', '\n', ' Red', '\n', ' red', '\n', '\n', ' red', '\n', ' WHITE', ' 0', " '", '\n', ' Type', ' choose', ' 7', ' checks']

Epoch 1/10:  13%|████████████████████████▌                                                                                                                                                               | 2/15 [01:40<10:52, 50.18s/it]
Traceback (most recent call last):
  File "/g/g10/smith585/codebases/collaborative-stegosystem/experiments/23_trl_wandb_log.py", line 197, in <module>
    sender_stats = sender_ppo_trainer.step(query_tensors, response_tensors, rewards)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/workspace/smith585/x86_miniconda/lib/python3.12/contextlib.py", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/workspace/smith585/x86_miniconda/lib/python3.12/site-packages/trl/trainer/ppo_trainer.py", line 818, in step
    logprobs, logits, vpreds, _ = self.batched_forward_pass(
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/workspace/smith585/x86_miniconda/lib/python3.12/contextlib.py", line 80, in inner
    with self._recreate_cm():
  File "/usr/workspace/smith585/x86_miniconda/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/usr/workspace/smith585/x86_miniconda/lib/python3.12/site-packages/trl/core.py", line 292, in empty_device_cache
    gc.collect()
KeyboardInterrupt